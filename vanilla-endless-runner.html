<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>8-Bit Endless Runner</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            font-family: 'Courier New', monospace;
        }
        
        .game-container {
            text-align: center;
        }
        
        canvas {
            border: 4px solid #0f3460;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            image-rendering: pixelated;
            image-rendering: crisp-edges;
        }
        
        .instructions {
            color: #94a3b8;
            margin-top: 20px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <canvas id="gameCanvas" width="800" height="400"></canvas>
        <div class="instructions">Click on the game or press SPACE to jump</div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // Game state
        let gameState = 'menu'; // menu, playing, gameover
        let score = 0;
        let highScore = 0;
        
        // Game object
        const game = {
            player: {
                x: 100,
                y: 300,
                width: 32,
                height: 32,
                velocityY: 0,
                isJumping: false
            },
            obstacles: [],
            powerups: [],
            ground: 350,
            speed: 5,
            gravity: 0.6,
            jumpForce: -12,
            frameCount: 0,
            invincible: false,
            invincibleTimer: 0
        };

        // Input handling
        window.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault();
                if (gameState === 'menu' || gameState === 'gameover') {
                    startGame();
                } else if (gameState === 'playing') {
                    jump();
                }
            }
        });

        canvas.addEventListener('click', () => {
            if (gameState === 'menu' || gameState === 'gameover') {
                startGame();
            } else if (gameState === 'playing') {
                jump();
            }
        });

        function startGame() {
            game.player.y = 300;
            game.player.velocityY = 0;
            game.player.isJumping = false;
            game.obstacles = [];
            game.powerups = [];
            game.speed = 5;
            game.frameCount = 0;
            game.invincible = false;
            game.invincibleTimer = 0;
            score = 0;
            gameState = 'playing';
        }

        function jump() {
            if (!game.player.isJumping) {
                game.player.velocityY = game.jumpForce;
                game.player.isJumping = true;
            }
        }

        // Drawing functions
        function drawPixelRect(x, y, w, h, color) {
            ctx.fillStyle = color;
            ctx.fillRect(Math.floor(x), Math.floor(y), w, h);
        }

        function drawPlayer() {
            const p = game.player;
            
            // Body - flashing colors when invincible
            if (game.invincible) {
                const colors = ['#FFD700', '#FFA500', '#FF6347'];
                const colorIndex = Math.floor(game.frameCount / 5) % colors.length;
                drawPixelRect(p.x, p.y, 32, 32, colors[colorIndex]);
            } else {
                drawPixelRect(p.x, p.y, 32, 32, '#FF6B6B');
            }
            
            // Eyes
            drawPixelRect(p.x + 8, p.y + 8, 6, 6, '#000');
            drawPixelRect(p.x + 18, p.y + 8, 6, 6, '#000');
            
            // Legs animation
            const legOffset = Math.floor(game.frameCount / 5) % 2 * 4;
            drawPixelRect(p.x + 6, p.y + 28, 8, 4, '#FF4757');
            drawPixelRect(p.x + 18, p.y + 28 + legOffset, 8, 4, '#FF4757');
        }

        function drawObstacle(obs) {
            // Cactus-like obstacle
            drawPixelRect(obs.x, obs.y, 24, 40, '#2ECC71');
            drawPixelRect(obs.x + 8, obs.y + 8, 8, 24, '#27AE60');
            drawPixelRect(obs.x, obs.y + 16, 8, 8, '#2ECC71');
            drawPixelRect(obs.x + 16, obs.y + 16, 8, 8, '#2ECC71');
        }

        function drawPowerup(pu) {
            const pulse = Math.sin(game.frameCount * 0.1) * 2;
            drawPixelRect(pu.x, pu.y + pulse, 20, 20, '#FFD700');
            drawPixelRect(pu.x + 4, pu.y + 4 + pulse, 12, 12, '#FFA500');
            drawPixelRect(pu.x + 8, pu.y + 8 + pulse, 4, 4, '#FF6347');
        }

        function drawGround() {
            drawPixelRect(0, game.ground, canvas.width, canvas.height - game.ground, '#8B4513');
            
            // Ground pattern
            for (let i = 0; i < canvas.width; i += 16) {
                const offset = (game.frameCount * game.speed) % 16;
                drawPixelRect(i - offset, game.ground, 8, 8, '#654321');
            }
        }

        function drawClouds() {
            for (let i = 0; i < 3; i++) {
                const x = ((game.frameCount * 2 + i * 200) % (canvas.width + 100)) - 50;
                const y = 50 + i * 40;
                drawPixelRect(x, y, 40, 16, '#ECF0F1');
                drawPixelRect(x + 8, y - 8, 24, 16, '#ECF0F1');
            }
        }

        function drawUI() {
            ctx.fillStyle = '#2C3E50';
            ctx.font = 'bold 20px monospace';
            ctx.fillText('Score: ' + score, 20, 30);
            
            if (game.invincible) {
                const timeLeft = Math.ceil(game.invincibleTimer / 60);
                ctx.fillStyle = '#FFD700';
                ctx.fillText('Shield: ' + timeLeft + 's', 20, 60);
            }
        }

        // Game logic
        function update() {
            if (gameState !== 'playing') return;

            game.frameCount++;

            // Update player
            game.player.velocityY += game.gravity;
            game.player.y += game.player.velocityY;

            if (game.player.y >= game.ground - game.player.height) {
                game.player.y = game.ground - game.player.height;
                game.player.velocityY = 0;
                game.player.isJumping = false;
            }

            // Spawn obstacles
            if (game.frameCount % 90 === 0) {
                game.obstacles.push({
                    x: canvas.width,
                    y: game.ground - 40,
                    width: 24,
                    height: 40
                });
            }

            // Spawn powerups
            if (game.frameCount % 300 === 0 && Math.random() > 0.5) {
                game.powerups.push({
                    x: canvas.width,
                    y: game.ground - 120,
                    width: 20,
                    height: 20
                });
            }

            // Update obstacles
            game.obstacles = game.obstacles.filter(obs => {
                obs.x -= game.speed;
                
                // Collision detection
                if (!game.invincible &&
                    game.player.x < obs.x + obs.width &&
                    game.player.x + game.player.width > obs.x &&
                    game.player.y < obs.y + obs.height &&
                    game.player.y + game.player.height > obs.y) {
                    gameState = 'gameover';
                    if (score > highScore) {
                        highScore = score;
                    }
                    return false;
                }
                
                return obs.x > -obs.width;
            });

            // Update powerups
            game.powerups = game.powerups.filter(pu => {
                pu.x -= game.speed;
                
                // Collision detection for powerup
                if (game.player.x < pu.x + pu.width &&
                    game.player.x + game.player.width > pu.x &&
                    game.player.y < pu.y + pu.height &&
                    game.player.y + game.player.height > pu.y) {
                    game.invincible = true;
                    game.invincibleTimer = 300; // 5 seconds at 60fps
                    return false;
                }
                
                return pu.x > -pu.width;
            });

            // Update invincibility
            if (game.invincible) {
                game.invincibleTimer--;
                if (game.invincibleTimer <= 0) {
                    game.invincible = false;
                }
            }

            // Increase difficulty
            if (game.frameCount % 300 === 0) {
                game.speed += 0.5;
            }

            // Update score
            score = Math.floor(game.frameCount / 10);
        }

        function draw() {
            // Clear canvas with sky color
            ctx.fillStyle = '#87CEEB';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            if (gameState === 'menu') {
                drawClouds();
                drawGround();
                
                ctx.fillStyle = '#2C3E50';
                ctx.font = 'bold 48px monospace';
                ctx.fillText('PIXEL RUNNER', canvas.width / 2 - 180, canvas.height / 2 - 60);
                ctx.font = '24px monospace';
                ctx.fillText('Click or Press SPACE to Start', canvas.width / 2 - 180, canvas.height / 2);
                ctx.font = '20px monospace';
                ctx.fillText('Jump to avoid obstacles!', canvas.width / 2 - 130, canvas.height / 2 + 40);
                ctx.fillText('Collect shields for invincibility!', canvas.width / 2 - 180, canvas.height / 2 + 70);
                
            } else if (gameState === 'playing') {
                drawClouds();
                drawGround();
                
                game.obstacles.forEach(drawObstacle);
                game.powerups.forEach(drawPowerup);
                drawPlayer();
                drawUI();
                
            } else if (gameState === 'gameover') {
                drawClouds();
                drawGround();
                
                ctx.fillStyle = '#E74C3C';
                ctx.font = 'bold 48px monospace';
                ctx.fillText('GAME OVER', canvas.width / 2 - 150, canvas.height / 2 - 40);
                ctx.fillStyle = '#2C3E50';
                ctx.font = '24px monospace';
                ctx.fillText('Score: ' + score, canvas.width / 2 - 70, canvas.height / 2 + 10);
                ctx.fillText('High Score: ' + highScore, canvas.width / 2 - 100, canvas.height / 2 + 45);
                ctx.font = '20px monospace';
                ctx.fillText('Click or Press SPACE to Restart', canvas.width / 2 - 180, canvas.height / 2 + 90);
            }
        }

        // Game loop
        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }

        // Start the game loop
        gameLoop();
    </script>
</body>
</html>